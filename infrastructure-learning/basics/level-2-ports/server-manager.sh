#!/bin/bash

# ã‚¤ãƒ³ãƒ•ãƒ©ç®¡ç†ã®åŸºç¤ - ã‚µãƒ¼ãƒ“ã‚¹ç›£è¦–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

echo "=== ã‚µãƒ¼ãƒãƒ¼ç®¡ç†ãƒ„ãƒ¼ãƒ« ==="
echo ""

case "$1" in
    status)
        echo "ğŸ“Š å‹•ä½œä¸­ã®Webã‚µãƒ¼ãƒãƒ¼:"
        echo "------------------------"
        # TODO(human): ã“ã“ã«å®Ÿè£…ã—ã¦ãã ã•ã„
        # 1. ps auxã‚³ãƒãƒ³ãƒ‰ã§python3ã®httpã‚µãƒ¼ãƒãƒ¼ãƒ—ãƒ­ã‚»ã‚¹ã‚’æ¢ã™
        # 2. grepã§çµã‚Šè¾¼ã‚€ï¼ˆhttp.serverã‚’å«ã‚€è¡Œï¼‰
        # 3. è¦‹ã¤ã‹ã£ãŸãƒ—ãƒ­ã‚»ã‚¹ã®æƒ…å ±ã‚’è¡¨ç¤º
        # ãƒ’ãƒ³ãƒˆ: ps aux | grep "python3.*http.server" | grep -v grep
        ;;
        
    ports)
        echo "ğŸšª ä½¿ç”¨ä¸­ã®ãƒãƒ¼ãƒˆ:"
        echo "------------------"
        ss -tlnp | grep -E "800[0-9]" 2>/dev/null || netstat -tln | grep -E "800[0-9]"
        ;;
        
    *)
        echo "ä½¿ã„æ–¹: $0 {status|ports}"
        echo "  status - å‹•ä½œä¸­ã®ã‚µãƒ¼ãƒãƒ¼ã‚’è¡¨ç¤º"
        echo "  ports  - ä½¿ç”¨ä¸­ã®ãƒãƒ¼ãƒˆã‚’è¡¨ç¤º"
        exit 1
        ;;
esac